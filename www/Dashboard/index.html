
<!DOCTYPE html>
<html>
<head>
    <title>AtmosphericX - Dashboard</title>
    <link rel="stylesheet" href="./CSS/index.css">
    <script src="./JavaScript/Site.js"></script>
    <script src="./JavaScript/ActiveMessage.js"></script>
</head>
<body>
    <header>
        <div class="header-navagation">
            <h2 style="color: white; position: fixed; top: 0; left: 0; padding-left: calc(1em + 2px);">AtmosphericX</h2>
            <nav>
                <ul>
                    <li><a href="#">Dashboard</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <div class="wrapper">
        <div class="dashboard">
            <div class="dashboard-item">
                <h2>About AtmosphericX</h2>
                <p>
                    AtmosphericX is a web application that uses the National Weather Service API to provide real-time weather alerts and outlooks. 
                    The application can be used by storm chasers, emergency management, and the general public to stay informed about severe weather.
                    Please note that this application is still in development and may not be fully functional. Also please note that information provided by this application should not be used as the 
                    sole source of information for severe weather events. Always refer to the National Weather Service for the most accurate and up-to-date information or your NOAA Weather Radio.
                </p>
            </div>
        </div>
        <div class="dashboard-collums">
            <div class="dashboard-item" style="text-align: center;">
                <h2>Active Warnings</h2>
                <p id="active_warnings">0</p>
            </div>
            <div class="dashboard-item" style="text-align: center;">
                <h2>Active Watches</h2>
                <p id="active_watches">0</p>
            </div>
        </div>
        
        <div class="dashboard">
            <div class="dashboard-item">
                <h2>Last Message</h2>
                <p id="last_updated">Last Updated: NaN</p>
                <p id="latest_message">No Alert Found</p>
                <p id="latest_message_loco">N/A</p>
            </div>
        </div>
        <div class="dashboard">
            <div class="dashboard-item">
                <h2>Active Alerts</h2>
                <table class="table" style="width:100%; text-align: center;">
                    <thead>
                        <tr>
                            <th>STATE</th>
                            <th>TOTAL COUNTIES/AREAS AFFECTED</th>
                            <th>LAST ALERT</th>
                            <th>UPDATED</th>
                            <th>VIEW</th>
                        </tr>
                    </thead>
                    <tbody id="active_alerts">
                    </tbody>
                </table>
                <hr>
                <div id="widget" style="width:100%; display: none; flex-direction: column; text-align: center;">
                    <h1 id="title_place">Loading State Name</h1>

                    <table class="table" style="width:100%; text-align: center;">
                        <thead>
                            <tr>
                                <th>TYPE</th>
                                <th>AREA</th>
                                <th>WIND MPH</th>
                                <th>HAIL IN</th>
                                <th>TORR PROB</th>
                                <th>DESTRUCT PROB</th>
                                <th>MESSAGE</th>
                                <th>EXPIRES</th>
                                <th>DESCRIPTION</th>
                                <th>RAW DATA</th>
                            </tr>
                        </thead>
                        <tbody id="active_alerts_state">

                        </tbody>
                    </table>
                    <span class="close" onclick="widget_close()">GO BACK</span>
                </div>
            </div>
        </div>
        <div class="dashboard">
            <div class="dashboard-item">
                <h2>Manual Override</h2>
                <small>Select the event type, action, and listing type. Then enter the alert title and click submit.</small>
                <select class="form-control" id="eventType_sel">
                    <option>Tornado Emergency</option>
                    <option>PDS</option>
                    <option>Tornado Warning</option>
                    <option>Tornado Watch</option>
                    <option>Considerable Destructive Severe Thunderstorm Warning</option>
                    <option>Destructive Severe Thunderstorm Warning</option>
                    <option>Severe Thunderstorm Warning</option>
                    <option>Severe Thunderstorm Watch</option>
                    <option>Special Marine Warning</option>
                    <option>Flash Flood Warning</option>
                    <option>Flash Flood Watch</option>
                    <option>Snow Squall Warning</option>
                 </select>
                 <select class="form-control" id="eventAction_sel">
                    <option>Alert</option>
                    <option>Update</option>
                    <option>Cancel</option>
                 </select>
                 <select class="form-control" id="eventListing_sel">
                    <option>OBSERVED</option>
                    <option>RADAR INDICATED</option>
                 </select>
                 <input type="text" class="form-control" id="alert_title" placeholder="Somewhere, ST;">
                 <button type="button" class="btn btn-primary" id="submit_alert">Submit</button>
            </div>  
        </div>
        <div class="dashboard-collums" style="padding-bottom: 5%">
            <div class="dashboard-item" style="text-align: center;">
                <h2>SPC Day (1) Risk</h2>
                <iframe class="iframe-spc" src="https://www.spc.noaa.gov/products/outlook/day1otlk_prt.html"></iframe>
            </div>
            <div class="dashboard-item" style="text-align: center;">
                <h2>SPC Day (2) Risk</h2>
                <iframe class="iframe-spc" src="https://www.spc.noaa.gov/products/outlook/day2otlk_prt.html"></iframe>
            </div>
        </div>

    </div>  
    <footer class="footer">
        <p>AtmosphericX &copy; 2024 | Made with &hearts; by <a href="https://www.github.com/k3yomi">kiyomi</a></p>
    </footer>
</body>

<script>
    
    let dropdown = document.getElementById('submit_alert');
    dropdown.addEventListener('click', function(event) {
        let get_eventType = document.getElementById('eventType_sel').value;
        let get_eventAction = document.getElementById('eventAction_sel').value;
        let get_eventListing = document.getElementById('eventListing_sel').value;
        let get_locations = document.getElementById('alert_title').value;
        let ip = window.location.protocol + "//" + window.location.host;
        let url = ip + "/api/manual"
        let post_dta = {
            "event": get_eventType,
            "properties": {
                "event": get_eventType,
                "description": "N/A",
                "messageType": get_eventAction,
                "expires": "N/A",
                "indiciated": get_eventListing,
                "areaDesc": get_locations,
                "parameters": {
                    "thunderstormDamageThreat": "N/A",
                    "tornadoDetection": get_eventListing,
                }
            }
        }
        console.log(post_dta);
        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(post_dta)
        })
    });
</script>
</html>
